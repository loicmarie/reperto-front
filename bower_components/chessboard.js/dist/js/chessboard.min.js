!function(){"use strict";function a(a){if("string"!=typeof a)return!1;var c=a.split("-");return 2!==c.length?!1:b(c[0])===!0&&b(c[1])===!0}function b(a){return"string"!=typeof a?!1:-1!==a.search(/^[a-h][1-8]$/)}function c(a){return"string"!=typeof a?!1:-1!==a.search(/^[bw][KQRNBP]$/)}function d(a){if("string"!=typeof a)return!1;a=a.replace(/ .+$/,"");var b=a.split("/");if(8!==b.length)return!1;for(var c=0;8>c;c++)if(""===b[c]||b[c].length>8||-1!==b[c].search(/[^kqrbnpKQRNBP1-8]/))return!1;return!0}function e(a){if("object"!=typeof a)return!1;for(var d in a)if(a.hasOwnProperty(d)===!0&&(b(d)!==!0||c(a[d])!==!0))return!1;return!0}function f(a){return a.toLowerCase()===a?"b"+a.toUpperCase():"w"+a.toUpperCase()}function g(a){var b=a.split("");return"w"===b[0]?b[1].toUpperCase():b[1].toLowerCase()}function h(a){if(d(a)!==!0)return!1;a=a.replace(/ .+$/,"");for(var b=a.split("/"),c={},e=8,g=0;8>g;g++){for(var h=b[g].split(""),i=0,k=0;k<h.length;k++)if(-1!==h[k].search(/[1-8]/)){var l=parseInt(h[k],10);i+=l}else{var m=j[i]+e;c[m]=f(h[k]),i++}e--}return c}function i(a){if(e(a)!==!0)return!1;for(var b="",c=8,d=0;8>d;d++){for(var f=0;8>f;f++){var h=j[f]+c;b+=a.hasOwnProperty(h)===!0?g(a[h]):"1"}7!==d&&(b+="/"),c--}return b=b.replace(/11111111/g,"8"),b=b.replace(/1111111/g,"7"),b=b.replace(/111111/g,"6"),b=b.replace(/11111/g,"5"),b=b.replace(/1111/g,"4"),b=b.replace(/111/g,"3"),b=b.replace(/11/g,"2")}var j="abcdefgh".split("");window.ChessBoard=window.ChessBoard||function(c,f){function g(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(a){var b=16*Math.random()|0;return b.toString(16)})}function k(a){return JSON.parse(JSON.stringify(a))}function l(a){var b=a.split(".");return{major:parseInt(b[0],10),minor:parseInt(b[1],10),patch:parseInt(b[2],10)}}function m(a,b){a=l(a),b=l(b);var c=1e4*a.major*1e4+1e4*a.minor+a.patch,d=1e4*b.major*1e4+1e4*b.minor+b.patch;return c>=d}function n(a,b,c){if(f.hasOwnProperty("showErrors")===!0&&f.showErrors!==!1){var d="ChessBoard Error "+a+": "+b;return"console"===f.showErrors&&"object"==typeof console&&"function"==typeof console.log?(console.log(d),void(arguments.length>=2&&console.log(c))):"alert"===f.showErrors?(c&&(d+="\n\n"+JSON.stringify(c)),void window.alert(d)):void("function"==typeof f.showErrors&&f.showErrors(a,b,c))}}function o(){if("string"==typeof c){if(""===c)return window.alert("ChessBoard Error 1001: The first argument to ChessBoard() cannot be an empty string.\n\nExiting..."),!1;var a=document.getElementById(c);if(!a)return window.alert('ChessBoard Error 1002: Element with id "'+c+'" does not exist in the DOM.\n\nExiting...'),!1;ha=$(a)}else if(ha=$(c),1!==ha.length)return window.alert("ChessBoard Error 1003: The first argument to ChessBoard() must be an ID or a single DOM node.\n\nExiting..."),!1;return window.JSON&&"function"==typeof JSON.stringify&&"function"==typeof JSON.parse?$.fn&&$.fn.jquery&&m($.fn.jquery,ra)===!0?!0:(window.alert("ChessBoard Error 1005: Unable to find a valid version of jQuery. Please include jQuery "+ra+" or higher on the page.\n\nExiting..."),!1):(window.alert("ChessBoard Error 1004: JSON does not exist. Please include a JSON polyfill.\n\nExiting..."),!1)}function p(a){return"fast"===a||"slow"===a?!0:parseInt(a,10)+""!=a+""?!1:a>=0}function q(){return("string"==typeof f||e(f)===!0)&&(f={position:f}),"black"!==f.orientation&&(f.orientation="white"),ya=f.orientation,f.showNotation!==!1&&(f.showNotation=!0),f.draggable!==!0&&(f.draggable=!1),"trash"!==f.dropOffBoard&&(f.dropOffBoard="snapback"),f.sparePieces!==!0&&(f.sparePieces=!1),f.sparePieces===!0&&(f.draggable=!0),(f.hasOwnProperty("pieceTheme")!==!0||"string"!=typeof f.pieceTheme&&"function"!=typeof f.pieceTheme)&&(f.pieceTheme="img/chesspieces/wikipedia/{piece}.png"),(f.hasOwnProperty("appearSpeed")!==!0||p(f.appearSpeed)!==!0)&&(f.appearSpeed=200),(f.hasOwnProperty("moveSpeed")!==!0||p(f.moveSpeed)!==!0)&&(f.moveSpeed=200),(f.hasOwnProperty("snapbackSpeed")!==!0||p(f.snapbackSpeed)!==!0)&&(f.snapbackSpeed=50),(f.hasOwnProperty("snapSpeed")!==!0||p(f.snapSpeed)!==!0)&&(f.snapSpeed=25),(f.hasOwnProperty("trashSpeed")!==!0||p(f.trashSpeed)!==!0)&&(f.trashSpeed=100),f.hasOwnProperty("position")===!0&&("start"===f.position?za=k(ta):d(f.position)===!0?za=h(f.position):e(f.position)===!0?za=k(f.position):n(7263,"Invalid value passed to config.position.",f.position)),!0}function r(){var a=parseInt(ha.width(),10);if(!a||0>=a)return 0;for(var b=a-1;b%8!==0&&b>0;)b--;return b/8}function s(){for(var a=0;a<j.length;a++)for(var b=1;8>=b;b++){var c=j[a]+b;Ca[c]=c+"-"+g()}for(var d="KQRBNP".split(""),a=0;a<d.length;a++){var e="w"+d[a],f="b"+d[a];Ba[e]=e+"-"+g(),Ba[f]=f+"-"+g()}}function t(){var a='<div class="'+ua.chessboard+'">';return f.sparePieces===!0&&(a+='<div class="'+ua.sparePieces+" "+ua.sparePiecesTop+'"></div>'),a+='<div class="'+ua.board+'"></div>',f.sparePieces===!0&&(a+='<div class="'+ua.sparePieces+" "+ua.sparePiecesBottom+'"></div>'),a+="</div>"}function u(a){"black"!==a&&(a="white");var b="",c=k(j),d=8;"black"===a&&(c.reverse(),d=1);for(var e="white",g=0;8>g;g++){b+='<div class="'+ua.row+'">';for(var h=0;8>h;h++){var i=c[h]+d;b+='<div class="'+ua.square+" "+ua[e]+" square-"+i+'" style="width: '+ma+"px; height: "+ma+'px" id="'+Ca[i]+'" data-square="'+i+'">',f.showNotation===!0&&(("white"===a&&1===d||"black"===a&&8===d)&&(b+='<div class="'+ua.notation+" "+ua.alpha+'">'+c[h]+"</div>"),0===h&&(b+='<div class="'+ua.notation+" "+ua.numeric+'">'+d+"</div>")),b+="</div>",e="white"===e?"black":"white"}b+='<div class="'+ua.clearfix+'"></div></div>',e="white"===e?"black":"white","white"===a?d--:d++}return b}function v(a){return"function"==typeof f.pieceTheme?f.pieceTheme(a):"string"==typeof f.pieceTheme?f.pieceTheme.replace(/{piece}/g,a):(n(8272,"Unable to build image source for cfg.pieceTheme."),"")}function w(a,b,c){var d='<img src="'+v(a)+'" ';return c&&"string"==typeof c&&(d+='id="'+c+'" '),d+='alt="" class="'+ua.piece+'" data-piece="'+a+'" style="width: '+ma+"px;height: "+ma+"px;",b===!0&&(d+="display:none;"),d+='" />'}function x(a){var b=["wK","wQ","wR","wB","wN","wP"];"black"===a&&(b=["bK","bQ","bR","bB","bN","bP"]);for(var c="",d=0;d<b.length;d++)c+=w(b[d],!1,Ba[b[d]]);return c}function y(a,b,c,d){var e=$("#"+Ca[a]),h=e.offset(),i=$("#"+Ca[b]),j=i.offset(),k=g();$("body").append(w(c,!0,k));var l=$("#"+k);l.css({display:"",position:"absolute",top:h.top,left:h.left}),e.find("."+ua.piece).remove();var m=function(){i.append(w(c)),l.remove(),"function"==typeof d&&d()},n={duration:f.moveSpeed,complete:m};l.animate(j,n)}function z(a,b,c){var d=$("#"+Ba[a]).offset(),e=$("#"+Ca[b]),h=e.offset(),i=g();$("body").append(w(a,!0,i));var j=$("#"+i);j.css({display:"",position:"absolute",left:d.left,top:d.top});var k=function(){e.find("."+ua.piece).remove(),e.append(w(a)),j.remove(),"function"==typeof c&&c()},l={duration:f.moveSpeed,complete:k};j.animate(h,l)}function A(a,b,c){function d(){e++,e===a.length&&(F(),wa=!1,f.hasOwnProperty("onMoveEnd")===!0&&"function"==typeof f.onMoveEnd&&f.onMoveEnd(k(b),k(c)))}if(0!==a.length){wa=!0;for(var e=0,g=0;g<a.length;g++)"clear"===a[g].type&&$("#"+Ca[a[g].square]+" ."+ua.piece).fadeOut(f.trashSpeed,d),"add"===a[g].type&&f.sparePieces!==!0&&$("#"+Ca[a[g].square]).append(w(a[g].piece,!0)).find("."+ua.piece).fadeIn(f.appearSpeed,d),"add"===a[g].type&&f.sparePieces===!0&&z(a[g].piece,a[g].square,d),"move"===a[g].type&&y(a[g].source,a[g].destination,a[g].piece,d)}}function B(a,b){a=a.split("");var c=j.indexOf(a[0])+1,d=parseInt(a[1],10);b=b.split("");var e=j.indexOf(b[0])+1,f=parseInt(b[1],10),g=Math.abs(c-e),h=Math.abs(d-f);return g>=h?g:h}function C(a){for(var b=[],c=0;8>c;c++)for(var d=0;8>d;d++){var e=j[c]+(d+1);a!==e&&b.push({square:e,distance:B(a,e)})}b.sort(function(a,b){return a.distance-b.distance});for(var f=[],c=0;c<b.length;c++)f.push(b[c].square);return f}function D(a,b,c){for(var d=C(c),e=0;e<d.length;e++){var f=d[e];if(a.hasOwnProperty(f)===!0&&a[f]===b)return f}return!1}function E(a,b){a=k(a),b=k(b);var c=[],d={};for(var e in b)b.hasOwnProperty(e)===!0&&a.hasOwnProperty(e)===!0&&a[e]===b[e]&&(delete a[e],delete b[e]);for(var e in b)if(b.hasOwnProperty(e)===!0){var f=D(a,b[e],e);f!==!1&&(c.push({type:"move",source:f,destination:e,piece:b[e]}),delete a[f],delete b[e],d[e]=!0)}for(var e in b)b.hasOwnProperty(e)===!0&&(c.push({type:"add",square:e,piece:b[e]}),delete b[e]);for(var e in a)a.hasOwnProperty(e)===!0&&d.hasOwnProperty(e)!==!0&&(c.push({type:"clear",square:e,piece:a[e]}),delete a[e]);return c}function F(){ia.find("."+ua.piece).remove();for(var a in za)za.hasOwnProperty(a)===!0&&$("#"+Ca[a]).append(w(za[a]))}function G(){ia.html(u(ya)),F(),f.sparePieces===!0&&("white"===ya?(ka.html(x("black")),la.html(x("white"))):(ka.html(x("white")),la.html(x("black"))))}function H(a,b){a=k(a);for(var c in b)if(b.hasOwnProperty(c)===!0&&a.hasOwnProperty(c)===!0){var d=a[c];delete a[c],a[b[c]]=d}return a}function I(a){var b=k(za),c=k(a),d=i(b),e=i(c);d!==e&&(f.hasOwnProperty("onChange")===!0&&"function"==typeof f.onChange&&f.onChange(b,c),za=a)}function J(a,b){for(var c in qa)if(qa.hasOwnProperty(c)===!0){var d=qa[c];if(a>=d.left&&a<d.left+ma&&b>=d.top&&b<d.top+ma)return c}return"offboard"}function K(){qa={};for(var a in Ca)Ca.hasOwnProperty(a)===!0&&(qa[a]=$("#"+Ca[a]).offset())}function L(){ia.find("."+ua.square).removeClass(ua.highlight1+" "+ua.highlight2)}function M(){function a(){F(),ja.css("display","none"),f.hasOwnProperty("onSnapbackEnd")===!0&&"function"==typeof f.onSnapbackEnd&&f.onSnapbackEnd(na,pa,k(za),ya)}if("spare"===pa)return void N();L();var b=$("#"+Ca[pa]).offset(),c={duration:f.snapbackSpeed,complete:a};ja.animate(b,c),Aa=!1}function N(){L();var a=k(za);delete a[pa],I(a),F(),ja.fadeOut(f.trashSpeed),Aa=!1}function O(a){L();var b=k(za);delete b[pa],b[a]=na,I(b);var c=$("#"+Ca[a]).offset(),d=function(){F(),ja.css("display","none"),f.hasOwnProperty("onSnapEnd")===!0&&"function"==typeof f.onSnapEnd&&f.onSnapEnd(pa,a,na)},e={duration:f.snapSpeed,complete:d};ja.animate(c,e),Aa=!1}function P(a,b,c,d){("function"!=typeof f.onDragStart||f.onDragStart(a,b,k(za),ya)!==!1)&&(Aa=!0,na=b,pa=a,oa="spare"===a?"offboard":a,K(),ja.attr("src",v(b)).css({display:"",position:"absolute",left:c-ma/2,top:d-ma/2}),"spare"!==a&&$("#"+Ca[a]).addClass(ua.highlight1).find("."+ua.piece).css("display","none"))}function Q(a,c){ja.css({left:a-ma/2,top:c-ma/2});var d=J(a,c);d!==oa&&(b(oa)===!0&&$("#"+Ca[oa]).removeClass(ua.highlight2),b(d)===!0&&$("#"+Ca[d]).addClass(ua.highlight2),"function"==typeof f.onDragMove&&f.onDragMove(d,oa,pa,na,k(za),ya),oa=d)}function R(a){var c="drop";if("offboard"===a&&"snapback"===f.dropOffBoard&&(c="snapback"),"offboard"===a&&"trash"===f.dropOffBoard&&(c="trash"),f.hasOwnProperty("onDrop")===!0&&"function"==typeof f.onDrop){var d=k(za);"spare"===pa&&b(a)===!0&&(d[a]=na),b(pa)===!0&&"offboard"===a&&delete d[pa],b(pa)===!0&&b(a)===!0&&(delete d[pa],d[a]=na);var e=k(za),g=f.onDrop(pa,a,na,d,e,ya);("snapback"===g||"trash"===g)&&(c=g)}"snapback"===c?M():"trash"===c?N():"drop"===c&&O(a)}function S(){return"ontouchstart"in document.documentElement}function T(){return navigator&&navigator.userAgent&&-1!==navigator.userAgent.search(/MSIE/)}function U(a){a.preventDefault()}function V(a){if(f.draggable===!0){var c=$(this).attr("data-square");b(c)===!0&&za.hasOwnProperty(c)===!0&&P(c,za[c],a.pageX,a.pageY)}}function W(a){if(f.draggable===!0){var c=$(this).attr("data-square");b(c)===!0&&za.hasOwnProperty(c)===!0&&(a=a.originalEvent,P(c,za[c],a.changedTouches[0].pageX,a.changedTouches[0].pageY))}}function X(a){if(f.sparePieces===!0){var b=$(this).attr("data-piece");P("spare",b,a.pageX,a.pageY)}}function Y(a){if(f.sparePieces===!0){var b=$(this).attr("data-piece");a=a.originalEvent,P("spare",b,a.changedTouches[0].pageX,a.changedTouches[0].pageY)}}function Z(a){Aa===!0&&Q(a.pageX,a.pageY)}function _(a){Aa===!0&&(a.preventDefault(),Q(a.originalEvent.changedTouches[0].pageX,a.originalEvent.changedTouches[0].pageY))}function aa(a){if(Aa===!0){var b=J(a.pageX,a.pageY);R(b)}}function ba(a){if(Aa===!0){var b=J(a.originalEvent.changedTouches[0].pageX,a.originalEvent.changedTouches[0].pageY);R(b)}}function ca(a){if(Aa===!1&&f.hasOwnProperty("onMouseoverSquare")===!0&&"function"==typeof f.onMouseoverSquare){var c=$(a.currentTarget).attr("data-square");if(b(c)===!0){var d=!1;za.hasOwnProperty(c)===!0&&(d=za[c]),f.onMouseoverSquare(c,d,k(za),ya)}}}function da(a){if(Aa===!1&&f.hasOwnProperty("onMouseoutSquare")===!0&&"function"==typeof f.onMouseoutSquare){var c=$(a.currentTarget).attr("data-square");if(b(c)===!0){var d=!1;za.hasOwnProperty(c)===!0&&(d=za[c]),f.onMouseoutSquare(c,d,k(za),ya)}}}function ea(){$("body").on("mousedown mousemove","."+ua.piece,U),ia.on("mousedown","."+ua.square,V),ha.on("mousedown","."+ua.sparePieces+" ."+ua.piece,X),ia.on("mouseenter","."+ua.square,ca).on("mouseleave","."+ua.square,da),T()===!0?(document.ondragstart=function(){return!1},$("body").on("mousemove",Z).on("mouseup",aa)):$(window).on("mousemove",Z).on("mouseup",aa),S()===!0&&(ia.on("touchstart","."+ua.square,W),ha.on("touchstart","."+ua.sparePieces+" ."+ua.piece,Y),$(window).on("touchmove",_).on("touchend",ba))}function fa(){s(),ha.html(t()),ia=ha.find("."+ua.board),f.sparePieces===!0&&(ka=ha.find("."+ua.sparePiecesTop),la=ha.find("."+ua.sparePiecesBottom));var a=g();$("body").append(w("wP",!0,a)),ja=$("#"+a),xa=parseInt(ia.css("borderLeftWidth"),10),va.resize()}function ga(){o()===!0&&q()===!0&&(fa(),ea())}f=f||{};var ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra="1.7.0",sa="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",ta=h(sa),ua={alpha:"alpha-d2270",black:"black-3c85d",board:"board-b72b1",chessboard:"chessboard-63f37",clearfix:"clearfix-7da63",highlight1:"highlight1-32417",highlight2:"highlight2-9c5d2",notation:"notation-322f9",numeric:"numeric-fc462",piece:"piece-417db",row:"row-5277c",sparePieces:"spare-pieces-7492f",sparePiecesBottom:"spare-pieces-bottom-ae20f",sparePiecesTop:"spare-pieces-top-4028b",square:"square-55d63",white:"white-1e1d7"},va={},wa=!1,xa=2,ya="white",za={},Aa=!1,Ba={},Ca={};return va.clear=function(a){va.position({},a)},va.destroy=function(){ha.html(""),ja.remove(),ha.unbind()},va.fen=function(){return va.position("fen")},va.flip=function(){return va.orientation("flip")},va.move=function(){if(0!==arguments.length){for(var b=!0,c={},d=0;d<arguments.length;d++)if(arguments[d]!==!1)if(a(arguments[d])===!0){var e=arguments[d].split("-");c[e[0]]=e[1]}else n(2826,"Invalid move passed to the move method.",arguments[d]);else b=!1;var f=H(za,c);return va.position(f,b),f}},va.orientation=function(a){return 0===arguments.length?ya:"white"===a||"black"===a?(ya=a,G(),ya):"flip"===a?(ya="white"===ya?"black":"white",G(),ya):void n(5482,"Invalid value passed to the orientation method.",a)},va.position=function(a,b){return 0===arguments.length?k(za):"string"==typeof a&&"fen"===a.toLowerCase()?i(za):(b!==!1&&(b=!0),"string"==typeof a&&"start"===a.toLowerCase()&&(a=k(ta)),d(a)===!0&&(a=h(a)),e(a)!==!0?void n(6482,"Invalid value passed to the position method.",a):void(b===!0?(A(E(za,a),za,a),I(a)):(I(a),F())))},va.resize=function(){ma=r(),ia.css("width",8*ma+"px"),ja.css({height:ma,width:ma}),f.sparePieces===!0&&ha.find("."+ua.sparePieces).css("paddingLeft",ma+xa+"px"),G()},va.start=function(a){va.position("start",a)},ga(),va},window.ChessBoard.fenToObj=h,window.ChessBoard.objToFen=i}();